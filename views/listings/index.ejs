<% layout("/layouts/Boilerplate") %>
<style>
  /*  Horizontal filters container */
  #filters {
    display: flex;
    flex-wrap: nowrap;
    align-items: center;
    overflow-x: auto;
    white-space: nowrap;
    padding: 0.5rem 0;
    gap: 2rem;
    width: 100%;
  }

  /* Every filter icon box */
  .filter {
    text-align: center;
    opacity: 0.7;
    flex-shrink: 0;
  }

  .filter:hover {
    opacity: 1;
  }

  .filter p {
    font-size: 0.8rem;
  }

  /* Links */
  #filters a {
    text-decoration: none;
    color: #000;
  }

  #filters a:hover {
    color: #fe424d;
  }

  /* GST text */
  .tax-info {
    display: none;
  }

  /*  Rectangle toggle box */
  .tax-toggle {
    display: flex;
    align-items: center;
    border: 1.2px solid #000;
    border-radius: 1.5rem;
    height: 2.6rem;
    padding: 0 1.2rem;
    flex-shrink: 0;
    white-space: nowrap;
    font-size: 1.1rem;
    gap: 0.8rem;
    cursor: pointer;
    background: #fff !important; /* ← Fix: override bootstrap */
    transition: border 0.2s, background 0.2s;
    margin-top: 0.2rem; /* ← PERFECT ALIGNMENT FIX */
  }

  .tax-toggle:hover {
    background: #f3f3f3 !important;
  }

  /* Checkbox inside toggle */
  .form-check-input {
    margin: 0;
    cursor: pointer;
    transform: scale(1.15);
    border: 1px solid #888 !important; /* override bootstrap */
  }

  /* “Display Taxes” text */
  .pill-label {
    font-weight: 600;
    font-size: 1rem;
    color: #222;
    cursor: pointer;
  }

  /* Listing cards */
  .list:hover {
    opacity: 0.8;
  }

  .owner-info {
    font-size: 0.85rem;
    color: #555;
    margin-top: 0.3rem;
  }

  .listing-actions {
    margin-top: 0.5rem;
  }

  .listing-actions a,
  .listing-actions form button {
    font-size: 0.8rem;
    padding: 0.3rem 0.6rem;
  }
  .tax-toggle {
    transform: translateY(-13px); /* move up */
  }
</style>

<div id="filters">
  <!-- Categories -->
  <a href="/listings?category=trending">
    <div class="filter">
      <div><i class="fa-solid fa-fire"></i></div>
      <p>Trending</p>
    </div>
  </a>
  <a href="/listings?category=room">
    <div class="filter">
      <div><i class="fa-solid fa-bed"></i></div>
      <p>Rooms</p>
    </div>
  </a>
  <a href="/listings?category=beach">
    <div class="filter">
      <div><i class="fa-solid fa-water"></i></div>
      <p>Beaches</p>
    </div>
  </a>
  <a href="/listings?category=pool">
    <div class="filter">
      <div><i class="fa-solid fa-person-swimming"></i></div>
      <p>Pool</p>
    </div>
  </a>
  <a href="/listings?category=iconic-cities">
    <div class="filter">
      <div><i class="fa-solid fa-mountain-city"></i></div>
      <p>Iconic cities</p>
    </div>
  </a>
  <a href="/listings?category=mountain">
    <div class="filter">
      <div><i class="fa-solid fa-mountain"></i></div>
      <p>Mountains</p>
    </div>
  </a>
  <a href="/listings?category=farm">
    <div class="filter">
      <div><i class="fa-solid fa-cow"></i></div>
      <p>Farms</p>
    </div>
  </a>
  <a href="/listings?category=arctic">
    <div class="filter">
      <div><i class="fa-solid fa-snowflake"></i></div>
      <p>Arctic</p>
    </div>
  </a>
  <a href="/listings?category=camping">
    <div class="filter">
      <div><i class="fa-solid fa-campground"></i></div>
      <p>Camping</p>
    </div>
  </a>
  <a href="/listings?category=castle">
    <div class="filter">
      <div><i class="fa-solid fa-font-awesome"></i></div>
      <p>Castles</p>
    </div>
  </a>
  <a href="/listings?category=boat">
    <div class="filter">
      <div><i class="fa-solid fa-ship"></i></div>
      <p>Boats</p>
    </div>
  </a>
  <a href="/listings?category=dome">
    <div class="filter">
      <div><i class="fa-solid fa-igloo"></i></div>
      <p>Domes</p>
    </div>
  </a>

  <!--  Rectangle toggle -->
  <div
    class="tax-toggle"
    onclick="document.getElementById('switchCheckDefault').click()"
  >
    <input type="checkbox" id="switchCheckDefault" class="form-check-input" />
    <span class="pill-label">Display taxes</span>
  </div>
</div>

<div class="row row-cols-lg-3 row-cols-md-2 mt-2 row-cols-sm-1">
  <% for(let listing of allLists) { %> <% let imageUrl = null; if (typeof
  listing.image === 'string') imageUrl = listing.image; else if (listing.image
  && listing.image.url) imageUrl = listing.image.url; else imageUrl =
  '/images/placeholder.png'; %>
  <div class="col mb-4">
    <div class="card listing-card">
      <a href="/listings/<%= listing._id %>">
        <img
          src="<%= imageUrl %>"
          class="card-img-top list"
          alt="listingimage"
          style="height: 20rem"
          loading="lazy"
        />
      </a>
      <div class="card-body">
        <p class="card-text">
          <b><%= listing.title %></b><br />
          &#8377;<%= listing.price.toLocaleString("en-IN") %> for 2 nights
          <i class="tax-info">&nbsp;&nbsp; +18% GST </i>
        </p>
      </div>
    </div>
  </div>
  <% } %>
</div>

<script>
  let taxswitch = document.getElementById("switchCheckDefault");
  taxswitch.addEventListener("click", () => {
    let taxinfo = document.getElementsByClassName("tax-info");
    for (let info of taxinfo) {
      info.style.display = info.style.display !== "inline" ? "inline" : "none";
    }
  });
</script>
